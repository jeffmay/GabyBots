(function(A){TWP.Modules.Action={lazyLoaded:{rightRail:false,contentWell:false},objs:{},defaults:{thisNode:null,nodeRoot:null,nodeRootChild:null,nodeRootChildCategory:null,url:window.location.href,prodURL:"http://www.washingtonpost.com",testURL:"http://testweb8c.digitalink.com"},clearField:function(D,E){var B=A.trim(D.target.defaultValue);var C=A.trim(D.target.value);if(B==D.target.value){D.target.value="";if(E){E.call();}}},timeOffSetter:function(B){B.each(function(){var D=A(this).html();var D=new Date(D);storyTimeMS=D.getTime();var C=new Date().getTime();var E=(C-storyTimeMS)/60000;if(E<61){A(this).html(E);}else{A(this).html(D.toDateString()).addClass("old_ago").removeClass("hide");}});},updateShareData:function(E){var N=E.target;var B=A(N);var H=A(N.parentNode.parentNode);var K=B.attr("href");var C=B.text();var F="Aggregate";var L=H.attr("url");var M=H.attr("loidEx");var D=L+"?counter="+escape(C)+"&loid="+escape(M);var P=L+"?counter="+escape(F)+"&loid="+escape(M);var I="1";var J=I;var O=PortalCommons.postRemoteHTML(D,J);var G=PortalCommons.postRemoteHTML(P,J);if(C=="MySpace"){window.open("http://www.myspace.com/Modules/PostTo/Pages/?u="+encodeURIComponent(K),"ptm","height=450,width=440");}else{if(C!="Email"){window.open(K);}}return false;},init:function(){this.cacheObjs();this.setUpRightRail();var B=this.objs.TimeOffset;if(B.length>0){this.timeOffSetter(B);}var C=this.objs.needYear;if(C.length>0){this.getYear(C);}this.assignHandlers(this);this.fixBorders();this.setUpGalleries();},setUpRightRail:function(){var B=this.objs.RightRailModules;var C='<div class="right-rail-shadow"></div>';if(B.length>0){B.each(function(D,E){A(E).append(C);});}},getYear:function(B){B.each(function(){var C=new Date().getFullYear();A(this).html(C);});},cacheObjs:function(){this.objs.RightRail=A("#right-rail");this.objs.ContentWell=A("#content");this.objs.TabbedPanels=A(".tabbed-panels");this.objs.TabbedPanelsInner=A(".tabbed-panels-inner");this.objs.TabbedPanelsInnerInner=A(".tabbed-panels-inner-inner");this.objs.NetworkNews=A("#NN-module-rr");this.objs.Share=A("div.share,ul.share");this.objs.TimeOffset=A(".ago");this.objs.restoredInputs=A(".restore");this.objs.grids=A(".grid",this.objs.ContentWell);this.objs.packages=A(".package",this.objs.ContentWell);this.objs.jumpMenus=A(".jumpmenu");this.objs.needYear=A(".getYear");this.objs.newsletter=A(".newsletter-signup");this.objs.galleryCaptions=A(".gallery-caption");this.objs.RightRailModules=A(".component",this.objs.RightRail);},fixBorders:function(){var C=this.objs.grids;C.each(function(E,G){var H=A(G);var F=A(".wp-column",H);F.each(function(I,K){var L=A(K);var J=A(".module:last-child",L);J.css("padding-bottom","0");J.css("border-bottom","none");J.css("margin-bottom","0");});});var D=this.objs.packages;D.each(function(F,H){var I=A(H);var G=A(".module:last-child",I);G.css("padding-bottom","0");G.css("border-bottom","none");G.css("margin-bottom","0");var E=A(".grid:last-child",I);E.css("padding-bottom","0");E.css("border-bottom","none");E.css("margin-bottom","0");});var B=this.objs.TabbedPanels;B.each(function(E,G){var H=A(G);var F=A(".panel",H);F.each(function(I,K){var L=A(K);var J=A(".module:last-child",L);J.css("padding-bottom","0");J.css("border-bottom","none");J.css("margin-bottom","0");});});},jumpMenus:function(B){var C=A("option:selected",B).val();location.href=C;},setUpGalleries:function(){var B=this.objs.galleryCaptions;B.each(function(C,D){$this=A(D);var F=$this.find("a");var E=F.attr("href");$this.attr("href",E);});},assignHandlers:function(E){var D=this.objs.Share;var C=this.objs.restoredInputs;var G=this.objs.noUser;var F=this.objs.jumpMenus;var B=this.objs.galleryCaptions;B.click(function(H){H.preventDefault();var I=A(this).attr("href");window.location.href=I;});C.not(".autocomplete").focus(function(H){E.clearField(H);});if(F.length>0){F.change(function(){E.jumpMenus(this);});}if(D.length>0){D.click(function(H){H.preventDefault();TWP.Modules.Action.updateShareData(H);});}}};A(document).ready(function(){TWP.Modules.Action.init();});})(jQuery);TWP.Util.queryStringDebugger={init:function(){if(typeof jQuery!="undefined"){var A=this;A.count=0;jQuery("body").prepend('<div id="util_debug_1_0_0"></div>');setTimeout(function(){A.render();A.intervalId=setInterval(function(){A.render();},A.getInterval()*1000);},A.getTimeout()*1000);}},render:function(){var B=this;if(this.count<100){this.count++;var A="";jQuery("#util_debug_1_0_0").html("");jQuery.each(B.getFeaturesToDebug(),function(D,E){var C=B.getConfig();if(typeof B[E]=="function"){A+=B[E](C);}else{A+=B["debug"](E,E,C);}});jQuery("#util_debug_1_0_0").html(A);}else{clearInterval(B.intervalId);}return true;},getFeaturesToDebug:function(){var B=window.location.search.substring(1).split("&");for(var A=0;A<B.length;A++){var C=B[A].split("=");if(C[0]=="debug"){return C[1].split(",");}}return[];},getInterval:function(){var B=window.location.search.substring(1).split("&");for(var A=0;A<B.length;A++){var C=B[A].split("=");if(C[0].match(/refresh|interval/)){if(!isNaN(C[1])){return Math.floor(C[1]);}}}if(this.getFeaturesWithDefaultRefreshAsRe().test(this.getFeaturesToDebug())){return 10;}else{return(1<<16);}},getFeaturesWithDefaultRefreshAsRe:function(){return/(^|,)(omnitureEpaper)(,|$)/;},getTimeout:function(){var B=window.location.search.substring(1).split("&");for(var A=0;A<B.length;A++){var C=B[A].split("=");if(C[0].match(/wait|to|delay/)){if(!isNaN(C[1])){return Math.floor(C[1]);}}}return 0;},getConfig:function(){var A={};var C=window.location.search.substring(1).split("&");for(var B=0;B<C.length;B++){var D=C[B].split("=");if(D[0]!="debug"){if(D.length>1){switch(D[0]){case"ns":A["namespaceMatch"]=D[1];break;case"p":A["propMatch"]=D[1];break;case"nsp":A["nspMatch"]=D[1];break;case"v":A["valueMatch"]=D[1];break;case"reflection":if(!isNaN(D[1])){A[D[0]]=Math.floor(D[1]);}break;case"maxLength":if(!isNaN(D[1])){A[D[0]]=Math.floor(D[1]);}break;case"type":A["typeAsRe"]=D[1];break;case"echo":A["echo"]=(D[1]!="false");break;case"verbose":A["verbose"]=(D[1]=="true");break;default:A[D[0]]=D[1];}}}}if(typeof A.echo!="boolean"){A.echo=true;}return A;},debug:function(feature,namespace,cfg){var output="";if(!feature.match(/[;{}]/)){namespace=namespace||feature;if(typeof cfg.reflection!="number"){cfg.reflection=10;}try{var obj=eval(feature);cfg.ok_to_proceed=true;cfg.is_reference_to_window=(obj===window&&feature!="window");if(cfg.is_reference_to_window){output+=namespace+" = window;";output+=this.formatting.newline;}cfg.ok_to_proceed=cfg.ok_to_proceed&&!cfg.is_reference_to_window;if(cfg.ok_to_proceed){var type=typeof obj;if(obj&&obj.constructor.toString().match(/function Array/)){type="array";}if((typeof jQuery!="undefined"&&obj===jQuery)||(typeof YUI!="undefined"&&obj===YUI)||(typeof Prototype!="undefined"&&obj===Prototype)){type="object";}if(type=="undefined"){output="<strong>"+namespace+"</strong> is not defined";}else{if(obj===window||obj===document){jQuery.extend({reflection:1},cfg);}if(type.match(/array|object/)){output+="<strong>"+namespace+"</strong>"+this.formatting.newline;output+=this.objectToString(obj,namespace,cfg);}else{output+=this.echoValue(cfg,type,"",namespace,obj,true);}}}else{if(cfg.verbose){output+="<strong>"+namespace+"</strong>: Not ok to proceed with this object.";output+=this.formatting.newline;}}}catch(e){if(cfg.verbose){output+="<strong>"+namespace+"</strong>: Error in debug method: "+e;}}output=('<div class="'+this.tokenize(namespace)+'" style="text-align:center;"><div style="width:982px;margin:0 auto;text-align:left;font-family:courier,courier new;font-size:12px;padding:10px;background-color:#000;color:#0C0;border:3px solid #999;border-top:20px solid #999;max-height:325px;overflow:auto;margin-top:5px;-webkit-border-top-left-radius: 5px;-webkit-border-top-right-radius: 5px;-moz-border-radius-topleft: 5px;-moz-border-radius-topright: 5px;border-top-left-radius: 5px;border-top-right-radius: 5px;">'+output+"</div></div>");output+=this.formatting.newline;}return output;
},tracking:function(A){return this.debug("TWP.Data.Tracking.props","wp",A);},omniture:function(A){A=jQuery.extend({reflection:-1,typeAsRe:"(string|number|boolean)",maxLength:100,suppressedValues:[null,""]},A);return this.debug("s","s",A);},twp:function(A){return this.debug("TWP","TWP",A);},combo:function(A){var B="";for(var C in TWP.yuiConfig.groups){B+=this.debug("TWP.yuiConfig.groups."+C,"TWP.yuiConfig.groups."+C,A);}return B;},comboNames:function(A){A=jQuery.extend({reflection:-1,typeAsRe:"(undefined)"},A);var B="";B+=this.combo(A);return B;},comboGlobal:function(A){return this.debug("TWP.yuiConfig.groups.global","TWP.yuiConfig.groups.global",A);},comboEidosGlobal:function(A){return this.debug("TWP.yuiConfig.groups.eidosGlobal","TWP.yuiConfig.groups.eidosGlobal",A);},comboEidosMainContent:function(A){return this.debug("TWP.yuiConfig.groups.eidosMainContent","TWP.yuiConfig.groups.eidosMainContent",A);},comboEidosModules:function(A){return this.debug("TWP.yuiConfig.groups.eidosModules","TWP.yuiConfig.groups.eidosModules",A);},comboEidosVendors:function(A){return this.debug("TWP.yuiConfig.groups.eidosVendors","TWP.yuiConfig.groups.eidosVendors",A);},comboEidosHeader:function(A){return this.debug("TWP.yuiConfig.groups.eidosHeader","TWP.yuiConfig.groups.eidosHeader",A);},comboEidosCSS:function(A){return this.debug("TWP.yuiConfig.groups.eidosCSS","TWP.yuiConfig.groups.eidosCSS",A);},comboEidosInstantRun:function(A){return this.debug("TWP.yuiConfig.groups.eidosInstantRun","TWP.yuiConfig.groups.eidosInstantRun",A);},comboEidosComments:function(A){return this.debug("TWP.yuiConfig.groups.eidosComments","TWP.yuiConfig.groups.eidosComments",A);},comboEidosExternalCommentScripts:function(A){return this.debug("TWP.yuiConfig.groups.eidosExternalCommentScripts","TWP.yuiConfig.groups.eidosExternalCommentScripts",A);},comboEidosNetworkNews:function(A){return this.debug("TWP.yuiConfig.groups.eidosNetworkNews","TWP.yuiConfig.groups.eidosNetworkNews",A);},comboEidosJSONFeeds:function(A){return this.debug("TWP.yuiConfig.groups.eidosJSONFeeds","TWP.yuiConfig.groups.eidosJSONFeeds",A);},yui:function(A){return this.debug("YUI","YUI",A);},otto:function(A){var B="";if(window.otto){B+=otto.getInformation();B=this.formatFunction(B);}else{B="otto is undefined";}B=('<div class="'+this.tokenize("otto")+'" style="text-align:center;"><div style="width:982px;margin:0 auto;text-align:left;font-family:courier,courier new;font-size:12px;padding:10px;background-color:#000;color:#0C0;border:3px solid #999;border-top:20px solid #999;max-height:325px;overflow:auto;margin-top:5px;-webkit-border-top-left-radius: 5px;-webkit-border-top-right-radius: 5px;-moz-border-radius-topleft: 5px;-moz-border-radius-topright: 5px;border-top-left-radius: 5px;border-top-right-radius: 5px;">'+B+"</div></div>");B+=this.formatting.newline;return B;},omnitureEpaper:function(A){var B="";oCfg=jQuery.extend({nspMatch:"s.(prop|evar|channel|pageName|hier)"},A);B+=this.omniture(oCfg);B+=this.tracking(A);return B;},docwrite:function(A){A=jQuery.extend({reflection:-1,typeAsRe:"(function)",echo:false,valueMatch:"document.write"},jQuery.extend(A,{"echo":false}));return this.debug("window","window",A);},docwriteExposed:function(A){A=jQuery.extend({reflection:-1,typeAsRe:"(function)",echo:true,valueMatch:"document.write"},jQuery.extend(A,{"echo":true}));return this.debug("window","window",A);},objectToString:function(B,E,I){var C="";try{for(var A in B){var L=true;var O=true;var M=B[A];var K=typeof M;if(M&&M.constructor.toString().match(/function Array/)){K="array";}if(L&&I.namespaceMatch){L=L&&((new String(E)).match(new RegExp(I.namespaceMatch,"ig")));}if(L&&I.propMatch){L=L&&((new String(A)).match(new RegExp(I.propMatch,"ig")));}if(L&&I.nspMatch){L=L&&((new String(E+"."+A)).match(new RegExp(I.nspMatch,"ig")));}if(L&&I.valueMatch){L=L&&((new String(M)).match(new RegExp(I.valueMatch,"ig")));}if(L&&I.suppressedValues){for(var F=0;F<I.suppressedValues.length;F++){L=L&&(M!=I.suppressedValues[F]);}}if(I.typeAsRe){L=L&&(K.match(new RegExp(I.typeAsRe)));}if(this.reflection>I.reflection){O=false;}if(K.match(/array|object/)){if(O){try{var D=true;var N=(M===window&&A!="window");if(N){C+=this.getIndents();C+=(E+"."+A+" =  window;");C+=this.formatting.newline;}D=D&&!N;if(D){var G=(K=="object")?"{":"[";var P=(K=="object")?"}":"]";this.reflection++;this.isArrayContext=K.match(/array/);var H=this.objectToString(M,A,I);this.isArrayContext=false;this.reflection--;if(H){C+=this.getIndents();C+=(E+"."+A+": ");C+=this.formatting.newline;C+=this.getIndents();C+=G+this.formatting.newline;C+=H;C+=this.getIndents();C+=P+this.formatting.newline;}}else{if(I.verbose){C+="<strong>"+E+"</strong>: Not ok to proceed with this object.";C+=this.formatting.newline;}}}catch(J){if(I.verbose){C+=this.getIndents();C+=J+this.formatting.newline;}this.isArrayContext=false;this.reflection--;if(I.verbose){C+=this.getIndents();C+=P+this.formatting.newline;}}}else{if(I.verbose){C+=this.getIndents();C+=(E+"."+A+": ");C+=" too deep to reflect (>"+I.reflection+")."+this.formatting.newline;}}}else{C+=this.echoValue(I,K,E,A,M,L);}}}catch(J){if(I.verbose){C+="<strong>"+E+"</strong>: Error in objectToString method: "+J;}}return C;},echoValue:function(A,F,E,H,C,D){var B="";try{if(D){C=C.toString();if(typeof A.maxLength=="number"&&A.maxLength>=0){if(C.length>A.maxLength){C=C.substring(0,A.maxLength)+"...";}}if(!A.echo){C="&lt;&lt;value suppressed&gt;&gt;";}else{if(F.match(/function/)){C=this.formatFunction(C);}else{if(F.match(/number|boolean/)){C=C;}else{C='"'+C+'"';}}}B+=this.getIndents();if(E){B+=E;}if(this.isArrayContext){B+=("["+H+"] = "+C+";");}else{if(E){B+=".";}B+=(H+" = "+C+";");}B+=this.formatting.newline;}}catch(G){if(A.verbose){B+="<strong>"+E+"</strong>: Error in echoValue method: "+G;}}return B;},reflection:0,isArrayContext:false,formatting:{space:"&nbsp;",indent:"&nbsp;&nbsp;",newline:"<br/>"},tokenize:function(A){if(A.match(/^\s*([^\s]+)\s*/g)){A=RegExp.$1;}A=A.replace(/\s+/g,"_");A=A.replace(/[^A-Za-z0-9]+/g,"_");A=A.replace(/_+/g,"_");return A;},formatString:function(A){if(A){A=A.replace(/\</g,"&lt;");A=A.replace(/\>/g,"&gt;");}return A;},formatFunction:function(E,D,A){D=D||this.reflection;A=A||this.formatting.indent;var B=this;E=new String(E);E=this.formatString(E);var C=[];jQuery.each(C,function(G,F){E=E.replace(F.re,F.raw+B.formatting.newline+B.formatting.indent);});E=E.replace(/\n/g,this.formatting.newline+this.getIndents(D));E=E.replace(/\t/g,this.formatting.indent);E=E.replace(/\s/g,this.formatting.space);return E;},getIndents:function(D,A){D=D||this.reflection;A=A||this.formatting.indent;var B="";for(var C=0;C<D;C++){B+=A;}return B;}};TWP.Util.queryStringDebugger.init();