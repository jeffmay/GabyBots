(function(B,A){B.fn.JSONFeed=function(F){var I={url:"http://api.twitter.com/1/statuses/public_timeline.json",jsonp:"callback",jsonpCallback:"?",iterator:function(K){return K;},num:5,avatar_width:48,avatar_height:48,poll:0,pollUrlGenerator:function(K,M,L){return K;},paginate:false,paginationUrlGenerator:function(K,M,L){return K;},spinner:'<span class="jf-loading">Loading...</span>',newContentMessage:'<a href="#">Click to show new tweets.</a>',paginationButton:'<a href="#">Load more...</a>',template:'<p style="color:#a00">You haven&apos;t set a template for this feed!</p>',jsonVarP:/\{\{([^\}]+)\}\}/gm,optionP:/\{%([^%]+)%\}/gm,renderCallback:function(K){return K;},appendCallback:function(){}},H,E,D,C,J,G;H=function(K){if(B(K).attr("id")){return !B("#"+B(K).attr("id")).length;}else{return true;}};E=function(O,K,N){var L=B(K),Q=(L.attr("class").match(/page-/)!==null?"poll":"page"),M=L.parent().attr("data-num")||N.num,R={url:O||N.url,dataType:(N.jsonpCallback)?"jsonp":"json",success:function(W,S){L.find(".jf-spinner").remove();var X=N.iterator(W);B.each(X,function(Y,a){if(Y<M||Q==="poll"){var Z=B(D(a,N));if(H(Z)){L.append(Z);}}else{return false;}});if(!N.paginate&&X.length===0&&typeof N.empty!=="undefined"){L.append(N.empty);}if(Q==="poll"){if(L.children().length&&L.is(":hidden")){var T=L.siblings(".jf-show-new");if(T.length){L.before(T);}else{L.before(N.newContentMessage).prev().addClass("jf-show-new").hide().slideDown();}}var V=L.parent().data("_poll");V["data"]=W;L.parent().data("_poll",V);}else{if(X.length===0){L.siblings(".jf-show-more").remove();}else{L.siblings(".jf-show-more").removeClass("disabled");var U=L.parent().data("_page");if(U){U["data"]=W;L.parent().data("_page",U);}}}L.each(N.appendCallback);}};if(N.jsonpCallback){if(N.jsonpCallback!=="?"){R.jsonpCallback=N.jsonpCallback;R.jsonp=N.jsonp;}else{var P=R.url.split("?");R.url+=((P.length>1)?"&":"?")+N.jsonp+"="+N.jsonpCallback;}}B(L).append(B(N.spinner).addClass("jf-spinner"));if(R.url){B.ajax(R);}else{R.success([],"skipped");}};D=function(L,K){var M=K.template.replace(K.jsonVarP,function(O,N){var Q=N.split("."),P=L;B.each(Q,function(R,S){if(typeof P[S]!=="undefined"){P=P[S];}else{P="";}});return P;}).replace(K.optionP,function(O,N){var Q=N.split("."),P=K;B.each(Q,function(R,S){if(typeof K[S]!=="undefined"){P=P[S];}else{P="";}});return P;});return K.renderCallback(M);};C=function(K){return'<div class="jf-page page'+K+'"></div>';};J=function(K,M){console.log(K,M);var L=B(K),O=L.data("_poll");O.count+=1;var N=L.find(".jf-page").eq(0);if(N.children().length>0){O.page+=1;N=L.prepend(C(O.page*-1)).find(".page-"+O.page).eq(0).hide();}O.lastUrl=M.pollUrlGenerator(O.lastUrl,O["data"],M);L.data("_poll",O);E(O.lastUrl,N,M);A.setTimeout(function(){J(L,M);},O.interval*1000);};G=function(K,M){var L=B(K),O=L.data("_page");O.page+=1;var N=L.find(".jf-page").eq(-1).after(C(O.page)).next();O.lastUrl=M.paginationUrlGenerator(O.lastUrl,O["data"],M);L.data("_page",O);E(O.lastUrl,N,M);};return B(this).each(function(){var K=B(this),L=B.extend({},I,F,{url:K.attr("data-url")||F.url,poll:K.attr("data-poll")||F.poll,paginate:K.attr("data-paginate")||F.paginate}),M=K.append(C(0)).find(".page0").eq(0);E(L.url,M,L);B(this).delegate("a.jf-show-new","click",function(N){N.preventDefault();N.stopPropagation();B(this).nextAll(".jf-page").filter(":hidden").show();B(this).remove();});if(L.poll>0){K.data("_poll",{lastUrl:L.url,lastTime:new Date(),interval:L.poll,count:0,page:0});A.setTimeout(function(){J(K,L);},L.poll*1000);}if(L.paginate==="true"){K.data("_page",{lastUrl:L.url,page:0});K.append(B(L.paginationButton).addClass("jf-show-more").click(function(N){N.preventDefault();if(!B(this).hasClass("disabled")){B(this).addClass("disabled");G(K,L);}}));}});};B.fn.JSONFeed.docsURL="http://github.com/dandrinkard/jquery-json-feed/";B.fn.JSONFeed.presets=B.fn.JSONFeed.presets||{};B.fn.JSONFeed.utils=B.fn.JSONFeed.utils||{};})(jQuery,window);