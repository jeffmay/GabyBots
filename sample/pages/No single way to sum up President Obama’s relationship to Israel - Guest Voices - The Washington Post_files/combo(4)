TWP.Util.FormValidation={regexValidate:function(C,B){if(B!=null&&B.length>0){var A=new RegExp(B);return C.match(A);}else{return false;}},validateEmailAddress:function(A){return this.regexValidate(A,"^([a-zA-Z0-9_\\-\\.]+)@((\\[[0-9]{1,3}\\.[0-9]{1,3}\\.[0-9]{1,3}\\.)|(([a-zA-Z0-9\\-]+\\.)+))([a-zA-Z]{2,4}|[0-9]{1,3})(\\]?)$");},validateMultipleEmailAddresses:function(F,A){var D=false;var E=F.split(",");if(E.length){for(var C=0;C<E.length;C++){if(E[C]!=""){var B=E[C].replace(/^\s+|\s+$/g,"");D=this.regexValidate(B,"^([a-zA-Z0-9_\\-\\.]+)@((\\[[0-9]{1,3}\\.[0-9]{1,3}\\.[0-9]{1,3}\\.)|(([a-zA-Z0-9\\-]+\\.)+))([a-zA-Z]{2,4}|[0-9]{1,3})(\\]?)$");}else{D=false;}}}if(E.length>A||!D){return false;}return true;}};(function(A){TWP.Module.GlobalNewsletterForm=function(B){var B=B;var M=B.context;var K=[];var L=["wpniuser"];var F=false;var N=false;var E="";var D="Enter your e-mail address";var H=A(M).find('input[type="checkbox"]');var I=A(M).find(".email:eq(0)");var G=A(M).find(".errors:eq(0)");var C="";function J(){var O=false;C="";A(H).each(function(P){if(this.checked){var Q=A(this).attr("name");C=(C!="")?C+","+Q:Q;O=true;}});return O;}A("#distribution").submit(function(Q){Q.preventDefault();var O=J();var P=A(".submit-div");K=[];if(O==false){K.push("Please select one or more newsletters.");}A(G).empty();A(K).each(function(R){A(G).append("<li>"+K[R]+"</li>");A(G).show();});if(K.length==0){new TWP.Overlay(A("<iframe/>",{height:"500px",width:"950px",frameborder:"0",marginheight:"0px",marginwidth:"0px",src:TWP.signin.newsletterurl_overlay+"?newsletters="+C}),null);}return false;});};})(jQuery);